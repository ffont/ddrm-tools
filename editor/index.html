<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="3rdparty/bootstrap.min.css">
	<link rel="stylesheet" href="3rdparty/bootstrap-slider.min.css">
	<link rel="stylesheet" href="all.css">

	<title>DDRM Online Editor</title>
</head>

<body onload="init();">


	<div id="header">
		Deckard's Dream Timbre Space Demo
	</div>

	<nav class="navbar navbar-inverse" style="display: none;">
		<div class="container-fluid">
			<div class="navbar-header">
				<h4 id="presetTitle"></h4>
			</div>
			<div class="navbar-right">
				<div id="presetMetadata"></div>
			</div>
	</nav>

	<div id="timbreSpaceBgPad"></div>

	<div id="timbreSpacePad"></div>

	<div class="container-fluid">
		<div class="row">
			<div class="col-md-4" style="display:none;">
				<label>Load presets from bank file:</label>
				<form action='#' onsubmit="return false;">
					<input type='file' id='fileinput'>
					<button id='btnLoad' onclick='loadBankFile();'>Load</button>
				</form>
				<br>
				<div id="presetManagerControls"></div>
				<br>
				<div id="controlsPanelActions"></div>
				<br>
				<div id="timbreSpaceButtons"></div>
				<br>
				<div id="midiSettings"></div>
			</div>
			<div class="col-md" style="text-align: center;">
				<div id="timbreSpacePad"></div>
			</div>
		</div>

		<div id="bottomBar" class="row">
			<div id="bottomBarContent" class="row" style="height:320px;">
				<div id="synthTab" class="tab-pane active">
					<div class="col-md-12" style="text-align:center;">
						<div class="container-fluid">
							<div id="synthControls"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- JS -->
	<script type="text/javascript" src="3rdparty/noise.js"></script> <!-- TODO: credit this in README -->
	<script type="text/javascript" src="3rdparty/graphics.js"></script>  <!-- TODO: credit this in README -->
	<script type='text/javascript' src='3rdparty/delaunator.min.js'></script>  <!-- TODO: attribution https://github.com/mapbox/delaunator -->
	<script type='text/javascript' src='3rdparty/jquery.min.js'></script>
	<script type='text/javascript' src='3rdparty/bootstrap.min.js'></script>
	<script type='text/javascript' src='3rdparty/bootstrap-slider.min.js'></script>
	<script type='text/javascript' src='3rdparty/tabletop.min.js'></script>
	<script type='text/javascript' src='3rdparty/webmidi.min.js'></script>
	<script type='text/javascript' src='3rdparty/tsne.js'></script>
	<script type='text/javascript' src='globals.js'></script>
	<script type='text/javascript' src='utils.js'></script>
	<script type='text/javascript' src='midi.js'></script>
	<script type='text/javascript' src='store.js'></script>
	<script type='text/javascript' src='components.js'></script>
	<script type='text/javascript' src='ui.js'></script>
	<script type='text/javascript' src='space.js'></script>
	<script type='text/javascript'>
		function init() {
			initMIDI(document.getElementById("midiSettings"));
			SYNTH_UI_SCALE_FACTOR = 0.52;  // Use a fixed scale. Can also be automatically adjusted using autoAdjustUIScaleFactor()

			ONLINE_STORE = new GoogleSpreadsheetStore(
				scriptURL = "https://script.google.com/macros/s/AKfycbxdlE7J-VHEfSAEtj-MtA_MptxmtiMUWTbRU9oaU3zaZ-cSptW-/exec",
				spreadsheetURL = "https://docs.google.com/spreadsheets/d/10FpFlL8FKWJzRu2La21AdD-nhivl-7agzHNiIhQ5Llg/edit?usp=sharing");

			LOCAL_STORE = new LocalStore();
			PRESET_MANAGER = new PresetManager();

			//loadBankFromBytesArray("Factory Presets", FACTORY_BANK_BYTES);
			loadBankFromBytesArray("Paul Shilling's CS80 presets", CS80_BANK_BYTES);
			drawPresetControls();
			drawPresetManagerControls();

			PRESET_MANAGER.loadLocalAndOnlinePresets(function () {
				if (PRESET_MANAGER.currentPreset === undefined) {
					PRESET_MANAGER.setCurrentPresetToFirstPreset();
					drawPresetControls();
					//drawPresetManagerControls();
				}
			});

			PRESET_SPACE = new PresetSpace();
			drawPresetSpaceControls();
			document.getElementById("buildSpaceBtnId").click();
		}
	</script>
</body>

</html>